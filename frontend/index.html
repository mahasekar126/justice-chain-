<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JusticeChain Dashboard</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

<!-- Sidebar Navigation -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <div class="logo">
      <i class="fas fa-balance-scale"></i>
      <span>JusticeChain</span>
    </div>
    <button class="sidebar-toggle" id="sidebarToggle">
      <i class="fas fa-bars"></i>
    </button>
  </div>
  <nav class="sidebar-nav">
    <a href="#" class="nav-item active" data-section="overview">
      <i class="fas fa-tachometer-alt"></i>
      <span>Dashboard</span>
    </a>
    <a href="#" class="nav-item" data-section="cases">
      <i class="fas fa-folder-open"></i>
      <span>Cases</span>
    </a>
    <a href="#" class="nav-item" data-section="evidence">
      <i class="fas fa-file-alt"></i>
      <span>Evidence</span>
    </a>
    <a href="#" class="nav-item" data-section="reports">
      <i class="fas fa-chart-bar"></i>
      <span>Reports</span>
    </a>
    <a href="#" class="nav-item" data-section="settings">
      <i class="fas fa-cog"></i>
      <span>Settings</span>
    </a>
  </nav>
</div>

<!-- Main Content -->
<div class="main-content" id="mainContent">
  <!-- Header -->
  <header class="main-header">
    <div class="header-left">
      <button class="mobile-menu-btn" id="mobileMenuBtn">
        <i class="fas fa-bars"></i>
      </button>
      <div class="search-bar">
        <i class="fas fa-search"></i>
        <input type="text" placeholder="Search cases, evidence...">
      </div>
    </div>
    <div class="header-right">
      <button class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
      </button>
      <div class="notifications">
        <i class="fas fa-bell"></i>
        <span class="notification-badge">3</span>
      </div>
      <div class="user-profile">
        <div class="user-avatar">
          <i class="fas fa-user"></i>
        </div>
        <div class="user-info">
          <span class="user-name">Justice Officer</span>
          <span class="user-role" id="roleDisplay">Role: Admin</span>
        </div>
        <div class="user-menu">
          <button class="user-menu-btn">
            <i class="fas fa-chevron-down"></i>
          </button>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item">
              <i class="fas fa-user"></i> Profile
            </a>
            <a href="#" class="dropdown-item">
              <i class="fas fa-cog"></i> Settings
            </a>
            <a href="#" class="dropdown-item" id="logoutBtn">
              <i class="fas fa-sign-out-alt"></i> Logout
            </a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-content">
      <div class="hero-text">
        <h1>Welcome to JusticeChain</h1>
        <p>Secure, transparent, and efficient case management powered by blockchain technology</p>
        <div class="hero-stats">
          <div class="hero-stat">
            <span class="stat-number" id="heroTotalCases">0</span>
            <span class="stat-label">Total Cases</span>
          </div>
          <div class="hero-stat">
            <span class="stat-number" id="heroActiveCases">0</span>
            <span class="stat-label">Active Cases</span>
          </div>
          <div class="hero-stat">
            <span class="stat-number" id="heroResolvedCases">0</span>
            <span class="stat-label">Resolved Cases</span>
          </div>
        </div>
      </div>
      <div class="hero-actions">
        <button class="btn-primary" id="createCaseHeroBtn">
          <i class="fas fa-plus"></i> Create New Case
        </button>
        <button class="btn-secondary" onclick="document.querySelector('[data-section=\'cases\']').click()">
          <i class="fas fa-folder-open"></i> View All Cases
        </button>
      </div>
    </div>
    <div class="hero-visual">
      <div class="floating-elements">
        <div class="floating-card card-1">
          <i class="fas fa-balance-scale"></i>
        </div>
        <div class="floating-card card-2">
          <i class="fas fa-file-alt"></i>
        </div>
        <div class="floating-card card-3">
          <i class="fas fa-shield-alt"></i>
        </div>
      </div>
    </div>
  </section>

  <!-- Content Tabs -->
  <div class="content-tabs">
    <div class="tab-buttons">
      <button class="tab-btn active" data-tab="overview">Overview</button>
      <button class="tab-btn" data-tab="actions">Quick Actions</button>
      <button class="tab-btn" data-tab="activity">Recent Activity</button>
    </div>
    <div class="tab-content">
      <!-- Overview Tab -->
      <div class="tab-pane active" id="overview">
        <!-- Summary Cards -->
        <div class="summary-cards">
          <div class="summary-card">
            <div class="card-icon">
              <i class="fas fa-folder"></i>
            </div>
            <div class="card-content">
              <h3>Total Cases</h3>
              <p id="totalCases">0</p>
            </div>
          </div>
          <div class="summary-card">
            <div class="card-icon">
              <i class="fas fa-calendar-day"></i>
            </div>
            <div class="card-content">
              <h3>Cases Today</h3>
              <p id="casesToday">0</p>
            </div>
          </div>
          <div class="summary-card">
            <div class="card-icon">
              <i class="fas fa-clock"></i>
            </div>
            <div class="card-content">
              <h3>Pending Evidence</h3>
              <p id="pendingEvidence">0</p>
            </div>
          </div>
          <div class="summary-card">
            <div class="card-icon">
              <i class="fas fa-play-circle"></i>
            </div>
            <div class="card-content">
              <h3>Active Cases</h3>
              <p id="activeCases">0</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Actions Tab -->
      <div class="tab-pane" id="actions">
        <div class="dashboard-grid">

    <!-- TRACK CASE DETAIL -->
    <div class="card" id="caseDetailCard">
      <h2><i class="fa fa-info-circle"></i> View Case Details</h2>
      <input type="number" id="caseDetailId" placeholder="Enter Case ID">
      <button id="viewCaseDetailBtn">View Details</button>
      <div id="caseDetailResult"></div>
    </div>

    <!-- CREATE CASE -->
    <div class="card" id="createCaseCard" style="display: none;">
      <h2><i class="fa fa-file-circle-plus"></i> Create New Case</h2>
      <input type="text" id="title" placeholder="Case Title">
      <textarea id="description" placeholder="Case Description"></textarea>
      <input type="text" id="victimName" placeholder="Victim Name">
      <input type="text" id="accusedName" placeholder="Accused Name">
      <input type="text" id="location" placeholder="Incident Location">
      <textarea id="incidentDetails" placeholder="Incident Details"></textarea>
      <select id="caseType">
        <option value="">-- Case Type --</option>
        <option value="Civil">Civil</option>
        <option value="Criminal">Criminal</option>
        <option value="Property">Property</option>
        <option value="Fraud">Fraud</option>
      </select>
      <button id="createCaseBtn">Create Case</button>
    </div>

    <!-- ADD EVIDENCE -->
    <div class="card" id="evidenceCard" style="display: none;">
      <h2><i class="fa fa-folder-open"></i> Evidence Portal</h2>
      <input type="number" id="evidenceCaseId" placeholder="Case ID">
      <textarea id="evidenceText" placeholder="Evidence Details / Hash"></textarea>
      <button id="addEvidenceBtn">Add/View Evidence</button>
      <pre id="evidenceResult"></pre>
    </div>

    <!-- CASE STATUS -->
    <div class="card" id="statusCard" style="display: none;">
      <h2><i class="fa fa-tasks"></i> Track Status</h2>
      <input type="number" id="statusCaseId" placeholder="Enter Case ID">
      <button id="checkStatusBtn">Check Status</button>
      <pre id="statusResult"></pre>
    </div>

    <!-- CHECK STALE CASE -->
    <div class="card" id="staleCard" style="display: none;">
      <h2><i class="fa fa-hourglass-half"></i> Pending / Stale Cases</h2>
      <input type="number" id="staleCaseId" placeholder="Case ID">
      <button id="checkStaleBtn">Check Stale</button>
      <pre id="staleResult"></pre>
    </div>

    <!-- ADD JUDGMENT (JUDGE ONLY) -->
    <div class="card" id="judgmentCard" style="display: none;">
      <h2><i class="fa fa-gavel"></i> Add Judgment</h2>
      <input type="number" id="judgmentCaseId" placeholder="Case ID">
      <textarea id="judgmentText" placeholder="Judgment Details"></textarea>
      <input type="date" id="judgmentDate">
      <button id="addJudgmentBtn">Add Judgment</button>
      <pre id="judgmentResult"></pre>
    </div>

    <!-- RESOLVE CASE (JUDGE ONLY) -->
    <div class="card" id="resolveCard" style="display: none;">
      <h2><i class="fa fa-check-circle"></i> Resolve Case</h2>
      <input type="number" id="resolveCaseId" placeholder="Case ID">
      <button id="resolveCaseBtn">Mark as Resolved</button>
      <pre id="resolveResult"></pre>
    </div>

        </div>
      </div>

      <!-- Activity Tab -->
      <div class="tab-pane" id="activity">
        <div class="activity-feed">
          <h3>Recent Activity</h3>
          <div id="activityList">
            <!-- Activities will be loaded here -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<footer>
  <p>JusticeChain © 2025 | All Rights Reserved</p>
</footer>

<script src="frontend.js"></script>
<script>
  // ------------------------------
  // LOGIN CHECK
  // ------------------------------
  document.addEventListener("DOMContentLoaded", () => {
    const role = localStorage.getItem("role");
    const isLoggedIn = localStorage.getItem("isLoggedIn");

    if (!role || !isLoggedIn) {
      // Not logged in → redirect to login
      window.location.href = "login.html";
    } else {
      document.getElementById("roleDisplay").innerText = `Role: ${role}`;
    }

    // Load stats from server
    loadStats();

    // Load recent activities
    loadRecentActivities();

    // SHOW/HIDE ELEMENTS BASED ON ROLE
    if (role === "Public") {
      // Public users can only view case details
      document.getElementById("caseDetailCard").style.display = "block";
      document.getElementById("createCaseCard").style.display = "none";
      document.getElementById("evidenceCard").style.display = "none";
      document.getElementById("statusCard").style.display = "none";
      document.getElementById("staleCard").style.display = "none";
      document.getElementById("judgmentCard").style.display = "none";

      // Hide create case button in hero section for public users
      document.getElementById("createCaseHeroBtn").style.display = "none";
    } else {
      // Authorized users can see all cards except judgment (judge only)
      document.getElementById("caseDetailCard").style.display = "block";
      document.getElementById("createCaseCard").style.display = "block";
      document.getElementById("evidenceCard").style.display = "block";
      document.getElementById("statusCard").style.display = "block";
      document.getElementById("staleCard").style.display = "block";
      if (role === "Judge") {
        document.getElementById("judgmentCard").style.display = "block";
        document.getElementById("resolveCard").style.display = "block";
      }
    }

    // ------------------------------
    // LOGOUT BUTTON
    // ------------------------------
    const logoutBtn = document.getElementById("logoutBtn");
    logoutBtn.addEventListener("click", () => {
      localStorage.removeItem("role");
      localStorage.removeItem("isLoggedIn");
      window.location.href = "login.html";
    });

    // ------------------------------
    // SIDEBAR TOGGLE
    // ------------------------------
    const sidebarToggle = document.getElementById("sidebarToggle");
    const sidebar = document.getElementById("sidebar");
    const mainContent = document.getElementById("mainContent");

    sidebarToggle.addEventListener("click", () => {
      sidebar.classList.toggle("collapsed");
      mainContent.classList.toggle("sidebar-collapsed");
    });

    // ------------------------------
    // MOBILE MENU
    // ------------------------------
    const mobileMenuBtn = document.getElementById("mobileMenuBtn");

    mobileMenuBtn.addEventListener("click", () => {
      sidebar.classList.toggle("mobile-open");
    });

    // ------------------------------
    // TAB SWITCHING
    // ------------------------------
    const tabButtons = document.querySelectorAll(".tab-btn");
    const tabPanes = document.querySelectorAll(".tab-pane");

    tabButtons.forEach(button => {
      button.addEventListener("click", () => {
        // Remove active class from all buttons and panes
        tabButtons.forEach(btn => btn.classList.remove("active"));
        tabPanes.forEach(pane => pane.classList.remove("active"));

        // Add active class to clicked button and corresponding pane
        button.classList.add("active");
        const tabId = button.getAttribute("data-tab");
        document.getElementById(tabId).classList.add("active");
      });
    });

    // ------------------------------
    // THEME TOGGLE
    // ------------------------------
    const themeToggle = document.getElementById("themeToggle");
    const body = document.body;

    // Check for saved theme preference or default to dark
    const currentTheme = localStorage.getItem("theme") || "dark";
    body.setAttribute("data-theme", currentTheme);
    updateThemeIcon(currentTheme);

    themeToggle.addEventListener("click", () => {
      const currentTheme = body.getAttribute("data-theme");
      const newTheme = currentTheme === "dark" ? "light" : "dark";

      body.setAttribute("data-theme", newTheme);
      localStorage.setItem("theme", newTheme);
      updateThemeIcon(newTheme);
    });

    function updateThemeIcon(theme) {
      const icon = themeToggle.querySelector("i");
      icon.className = theme === "dark" ? "fas fa-sun" : "fas fa-moon";
    }

    // ------------------------------
    // USER MENU TOGGLE
    // ------------------------------
    const userMenuBtn = document.querySelector(".user-menu-btn");
    const dropdownMenu = document.querySelector(".dropdown-menu");

    userMenuBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      dropdownMenu.classList.toggle("show");
    });

    // Close dropdown when clicking outside
    document.addEventListener("click", () => {
      dropdownMenu.classList.remove("show");
    });

    // ------------------------------
    // BUTTON EVENT LISTENERS
    // ------------------------------
    document.getElementById("createCaseBtn").addEventListener("click", createCase);
    document.getElementById("addEvidenceBtn").addEventListener("click", addEvidence);
    document.getElementById("checkStatusBtn").addEventListener("click", checkStatus);
    document.getElementById("checkStaleBtn").addEventListener("click", checkStale);
    document.getElementById("addJudgmentBtn").addEventListener("click", addJudgment);
    document.getElementById("resolveCaseBtn").addEventListener("click", resolveCase);
    document.getElementById("viewCaseDetailBtn").addEventListener("click", viewCaseDetail);

    // Hero create case button - switch to actions tab and show create case card
    document.getElementById("createCaseHeroBtn").addEventListener("click", () => {
      document.querySelector('[data-tab="actions"]').click();
      document.getElementById("createCaseCard").style.display = "block";
    });

    // ------------------------------
    // NAVIGATION HANDLING
    // ------------------------------
    const navItems = document.querySelectorAll(".nav-item");

    navItems.forEach(item => {
      item.addEventListener("click", (e) => {
        e.preventDefault();
        const section = item.getAttribute("data-section");

        // Remove active class from all nav items
        navItems.forEach(nav => nav.classList.remove("active"));

        // Add active class to clicked item
        item.classList.add("active");

        // For now, just switch to overview tab when clicking dashboard
        if (section === "overview") {
          document.querySelector('[data-tab="overview"]').click();
        }
        // Add more section handling as needed
      });
    });
  });
</script>

</body>
</html>
